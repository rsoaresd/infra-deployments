# ----------------------------------------------------------------
# Generated by cli - DO NOT EDIT
# ----------------------------------------------------------------

apiVersion: toolchain.dev.openshift.com/v1alpha1
kind: TierTemplate
metadata:
  name: appstudio-env-env-1082365650-1082365650
  namespace: toolchain-host-operator
spec:
  revision: 1082365650-1082365650
  template:
    apiVersion: template.openshift.io/v1
    kind: Template
    metadata: {}
    objects:
    - apiVersion: v1
      kind: Namespace
      metadata:
        annotations:
          openshift.io/description: ${SPACE_NAME}
          openshift.io/display-name: ${SPACE_NAME}
          openshift.io/requester: ${SPACE_NAME}
        labels:
          appstudio.redhat.com/workspace_name: ${SPACE_NAME}
          argocd.argoproj.io/managed-by: gitops-service-argocd
          name: ${SPACE_NAME}-env
        name: ${SPACE_NAME}-env
    - apiVersion: v1
      kind: ServiceAccount
      metadata:
        name: namespace-manager
        namespace: ${SPACE_NAME}-env
    - apiVersion: rbac.authorization.k8s.io/v1
      kind: Role
      metadata:
        name: additional-argocd-read
        namespace: ${SPACE_NAME}-env
      rules:
      - apiGroups:
        - authorization.openshift.io
        - rbac.authorization.k8s.io
        resources:
        - roles
        verbs:
        - view
        - list
        - watch
      - apiGroups:
        - networking.k8s.io
        resources:
        - ingressclasses
        verbs:
        - view
        - list
        - watch
      - apiGroups:
        - ""
        resources:
        - persistentvolumes
        verbs:
        - view
        - list
        - watch
    - apiVersion: rbac.authorization.k8s.io/v1
      kind: RoleBinding
      metadata:
        name: additional-argocd-read
        namespace: ${SPACE_NAME}-env
      roleRef:
        apiGroup: rbac.authorization.k8s.io
        kind: Role
        name: additional-argocd-read
      subjects:
      - kind: ServiceAccount
        name: namespace-manager
    - apiVersion: rbac.authorization.k8s.io/v1
      kind: RoleBinding
      metadata:
        name: namespace-manager
        namespace: ${SPACE_NAME}-env
      roleRef:
        apiGroup: rbac.authorization.k8s.io
        kind: ClusterRole
        name: edit
      subjects:
      - kind: ServiceAccount
        name: namespace-manager
    - apiVersion: v1
      kind: ResourceQuota
      metadata:
        name: compute-deploy
        namespace: ${SPACE_NAME}-env
      spec:
        hard:
          limits.cpu: "20"
          limits.memory: ${MEMORY_LIMIT}
          requests.cpu: 1750m
          requests.memory: ${MEMORY_REQUEST}
        scopes:
        - NotTerminating
    - apiVersion: v1
      kind: ResourceQuota
      metadata:
        name: compute-build
        namespace: ${SPACE_NAME}-env
      spec:
        hard:
          cpu: 0
          memory: 0
          pods: 0
        scopes:
        - Terminating
    - apiVersion: v1
      kind: ResourceQuota
      metadata:
        name: storage
        namespace: ${SPACE_NAME}-env
      spec:
        hard:
          count/persistentvolumeclaims: "12"
          limits.ephemeral-storage: 50Gi
          requests.ephemeral-storage: 50Gi
          requests.storage: 50Gi
    - apiVersion: v1
      kind: LimitRange
      metadata:
        name: resource-limits
        namespace: ${SPACE_NAME}-env
      spec:
        limits:
        - default:
            cpu: 2000m
            memory: 2Gi
          defaultRequest:
            cpu: 10m
            memory: 256Mi
          type: Container
    - apiVersion: networking.k8s.io/v1
      kind: NetworkPolicy
      metadata:
        name: allow-same-namespace
        namespace: ${SPACE_NAME}-env
      spec:
        ingress:
        - from:
          - podSelector: {}
        podSelector: {}
    - apiVersion: networking.k8s.io/v1
      kind: NetworkPolicy
      metadata:
        name: allow-from-openshift-ingress
        namespace: ${SPACE_NAME}-env
      spec:
        ingress:
        - from:
          - namespaceSelector:
              matchLabels:
                network.openshift.io/policy-group: ingress
        podSelector: {}
        policyTypes:
        - Ingress
    - apiVersion: networking.k8s.io/v1
      kind: NetworkPolicy
      metadata:
        name: allow-from-openshift-monitoring
        namespace: ${SPACE_NAME}-env
      spec:
        ingress:
        - from:
          - namespaceSelector:
              matchLabels:
                network.openshift.io/policy-group: monitoring
        podSelector: {}
        policyTypes:
        - Ingress
    - apiVersion: networking.k8s.io/v1
      kind: NetworkPolicy
      metadata:
        name: allow-from-codeready-workspaces-operator
        namespace: ${SPACE_NAME}-env
      spec:
        ingress:
        - from:
          - namespaceSelector:
              matchLabels:
                network.openshift.io/policy-group: codeready-workspaces
        podSelector: {}
        policyTypes:
        - Ingress
    - apiVersion: networking.k8s.io/v1
      kind: NetworkPolicy
      metadata:
        name: allow-from-olm-namespaces
        namespace: ${SPACE_NAME}-env
      spec:
        ingress:
        - from:
          - namespaceSelector:
              matchLabels:
                openshift.io/scc: anyuid
        podSelector: {}
        policyTypes:
        - Ingress
    - apiVersion: networking.k8s.io/v1
      kind: NetworkPolicy
      metadata:
        name: allow-from-console-namespaces
        namespace: ${SPACE_NAME}-env
      spec:
        ingress:
        - from:
          - namespaceSelector:
              matchLabels:
                network.openshift.io/policy-group: console
        podSelector: {}
        policyTypes:
        - Ingress
    parameters:
    - name: SPACE_NAME
      required: true
    - name: MEMORY_LIMIT
      value: 32Gi
    - name: MEMORY_REQUEST
      value: 32Gi
    - name: MEMORY_BUILD_LIMIT
      value: 64Gi
    - name: MEMORY_BUILD_REQUEST
      value: 32Gi
  tierName: appstudio-env
  type: env
